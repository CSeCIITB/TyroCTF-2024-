// Basic JS code for interaction handling

document.addEventListener("DOMContentLoaded", function () {
    // Gets all components
    const getOtpButton = document.getElementById("get-otp-button");
    const submitOtpButton = document.getElementById("submit-otp-button");
    const otpInput = document.getElementById("otp-input");
    const mobileNumberInput = document.getElementById("mobile-number");

    // hide the otp input field and final button initially
    otpInput.style.display = "none";
    submitOtpButton.style.display = "none";
  
    // send request for otp
    getOtpButton.addEventListener("click", function () {
      getOtpButton.style.display = "none";
      otpInput.style.display = "block";
      submitOtpButton.style.display = "block";
    });
    
    // perform final validation for submitted responses
    submitOtpButton.addEventListener("click", function () {
      const mobileNumber = mobileNumberInput.value;
      const otp = otpInput.value;
      
      // Send the values to a PHP script using AJAX
      sendToPHP(mobileNumber, otp);

      // Clear the input fields after sending the data
      mobileNumberInput.value = '';
      otpInput.value = '';
    });
    
    // send the mobile and otp response to a PHP script which validates and gives access
    function sendToPHP(mobileNumber, otp) {
      const xhr = new XMLHttpRequest();
      xhr.open("POST", "http://localhost:8000/script.php", true);
      xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
      xhr.onreadystatechange = function () {
        if (xhr.readyState === 4 && xhr.status === 200) {
          // Handle the PHP script response here
          console.log(xhr.responseText);
        }
      };
      const data = `mobile=${mobileNumber}&otp=${otp}`;
      xhr.send(data);
    }
  });
  